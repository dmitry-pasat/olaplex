!function($){"use strict";$(function(){function o(){x=b.find(".woofc-body"),T=x.find("ul").eq(0),q=b.find(".woofc-checkout").find("span.amount"),F=b.find(".woofc-trigger"),S=F.find(".woofc-count"),I=b.find(".woofc-spinner-wrap"),O=b.find(".woofc-cart-error"),N=b.find(".woofc-undo")}function e(o,e,t){var n="webkitTransitionEnd otransitionend oTransitionEnd msTransitionEnd transitionend";e?o.one(n,function(){$(this).off(n),t($(this))}):o.on(n,function(){$(this).off(n),t($(this))})}function t(o,e,t){var n="webkitAnimationEnd oanimationend oAnimationEnd msAnimationEnd animationend";e?o.one(n,function(){$(this).off(n),t($(this))}):o.on(n,function(){$(this).off(n),t($(this))})}function n(o){A=!0;var t=void 0===o?b.hasClass("woofc-cart-open"):o;t?(b.removeClass("woofc-cart-open"),W=!1,f(),setTimeout(function(){x.scrollTop(0),v()},500)):(b.addClass("woofc-cart-open"),W=!0),e(b,!0,function(){A=!1,t?b.removeClass("woofc-cart-opened"):b.addClass("woofc-cart-opened")})}function a(o,e){if(E&&clearInterval(E),o.data("loading")||J)return!1;var t={fragments:e};o.removeClass("added"),o.data("loading",!0),o.addClass("loading"),c("add",t,function(e){o.removeClass("loading").addClass("added"),o.removeData("loading"),$(document.body).trigger("woofc_added_to_cart",[e]),E=setTimeout(function(){o.removeClass("added")},3e3)}),v()}function c(o,e,t){if($("html").addClass("woofc-loading"),$("body").hasClass("woocommerce-cart")){if(J)return!1;J=!0}if("remove"!==o&&"undo"!==o&&(Cookies.remove("woofc_last_removed"),N.removeClass("woofc-visible")),"refresh"===o)return i(o,t),!1;if("add"===o)return s(e,o,t),!1;var n={action:"woofc_update_cart",type:o};n=$.extend(n,e),$.woofcAjaxQueue({url:WOOFC.ajaxurl,data:n,type:"post"}),i(o,t)}function i(o,e){var t={url:wc_cart_fragments_params.wc_ajax_url.toString().replace("%%endpoint%%","get_refreshed_fragments"),type:"post",success:function(t){s(t,o,e)}};$.woofcAjaxQueue(t)}function s(o,e,t){"remove"===e||"undo"===e?$.each(o.fragments,function(o,e){"woofc"===o?(w(e.subtotal),m(e.total_items)):-1===o.search(".woofc")&&$(o).replaceWith(e)}):$.each(o.fragments,function(o,e){"woofc"!==o&&$(o).replaceWith(e)}),z&&(sessionStorage.setItem(wc_cart_fragments_params.fragment_name,JSON.stringify(o.fragments)),g(o.cart_hash),o.cart_hash&&p()),$(document.body).trigger("wc_fragments_refreshed"),v();var n=b.attr("data-loadingtimeout")?parseInt(b.attr("data-loadingtimeout")):0;setTimeout(function(){$("html").addClass("woofc-stoploading"),setTimeout(function(){$("html").removeClass("woofc-loading woofc-stoploading"),void 0!==t&&t(o)},n)},100),J=!1}function r(o,e,t){e>0?c("update",{cart_item_key:o,cart_item_qty:e},function(n){$(document.body).trigger("woofc_product_update",[o,e]),void 0!==t&&t(n)}):d(o,t)}function d(o,e){C();var t=new Date;t.setTime(t.getTime()+8e3),Cookies.set("woofc_last_removed",{key:o,html:T.find(".woofc-deleted"),position:T.find(".woofc-deleted").index()},{expires:t}),c("remove",{cart_item_key:o},function(){f();var t=T.find('li[data-key="'+o+'"]'),n=t.offset().top-x.children("ul").offset().top;t.css("top",n+"px"),t.addClass("woofc-deleted"),N.data("key",o).addClass("woofc-visible"),$(document.body).trigger("woofc_product_removed",[o]),v(),D=setTimeout(function(){f(),void 0!==e&&e()},8e3)})}function f(){D&&clearInterval(D),Cookies.remove("woofc_last_removed"),N.removeData("key").removeClass("woofc-visible"),T.find(".woofc-deleted").remove()}function u(o,e){c("undo",{cart_item_key:o},e)}function l(o){c("refresh",{},o)}function m(o){var e=b.hasClass("woofc-empty"),t=o+1;e?(S.find("li").eq(0).text(o),S.find("li").eq(1).text(t)):(S.addClass("woofc-update-count"),setTimeout(function(){S.find("li").eq(0).text(o)},150),setTimeout(function(){S.removeClass("woofc-update-count")},200),setTimeout(function(){S.find("li").eq(1).text(t)},230)),_()}function w(o){q=b.find(".woofc-checkout").find("span.amount"),q.html(o)}function v(){0===T.find("li:not(.woofc-deleted):not(.woofc-no-product)").length?b.addClass("woofc-empty"):b.removeClass("woofc-empty")}function _(){Number(S.find("li").eq(0).text())>99?S.addClass("woofc-count-big"):S.removeClass("woofc-count-big")}function p(){z&&sessionStorage.setItem("wc_cart_created",(new Date).getTime())}function g(o){z&&(localStorage.setItem(B,o),sessionStorage.setItem(B,o))}function h(o,n){C(),void 0!==n&&n.removeClass("woofc-shake"),O.removeClass("woofc-shake woofc-visible"),setTimeout(function(){O.text(o).addClass("woofc-visible"),e(O,!0,function(){O.addClass("woofc-shake"),void 0!==n&&n.addClass("woofc-shake"),t(O,!0,function(){O.removeClass("woofc-shake"),j=setTimeout(function(){O.removeClass("woofc-visible")},5e3)})})},100)}function C(){j&&clearInterval(j),N.removeClass("woofc-visible"),O.removeClass("woofc-visible")}function y(){return"ontouchstart"in document.documentElement?($("html").addClass("woofc-touchevents"),!0):($("html").addClass("woofc-no-touchevents"),!1)}if("undefined"==typeof wc_cart_fragments_params)return!1;var b=$(".woofc");if(b.length>0){var k=y(),x,T,q,F,S,I,O,N,j,D,E,D,E,W=!1,A=!1,Q=!1,J=!1;o();var z,B=wc_cart_fragments_params.ajax_url.toString()+"-wc_cart_hash";try{z="sessionStorage"in window&&null!==window.sessionStorage,window.sessionStorage.setItem("wc","test"),window.sessionStorage.removeItem("wc"),window.localStorage.setItem("wc","test"),window.localStorage.removeItem("wc")}catch(o){z=!1}$(document.body).on("added_to_cart",function(o,e,t,n){a(n,e)}),$(document.body).on("updated_wc_div updated_cart_totals applied_coupon removed_coupon",function(){Q||l()}),$(document.body).on("wc_fragments_refreshed",function(){T=x.find("ul").eq(0),q=b.find(".woofc-checkout").find("span.amount")}),$("body").hasClass("woocommerce-cart")&&$(document.body).on("woofc_product_update woofc_product_removed woofc_undo_product_remove",function(){J||(Q=!0,$(document.body).trigger("wc_update_cart"),$(document).ajaxComplete(function(o,e,t){t.url===wc_cart_fragments_params.wc_ajax_url.toString().replace("%%endpoint%%","get_refreshed_fragments")&&(Q=!1,$(o.currentTarget).unbind("ajaxComplete"))}))}),$(document.body).on("wc_fragments_refreshed",function(){o(),$("body").hasClass("woocommerce-checkout")&&$(document.body).trigger("update_checkout")}),F.on("vclick",function(o){o.preventDefault(),A||n()}),b.on("vclick",function(o){$(o.target).is($(this))&&n(!0)}),x.on("vclick",".woofc-delete-item",function(o){o.preventDefault(),d($(o.target).parents(".woofc-product").data("key"))}),$(document).on("change",".woofc-quantity input",function(){var o=$(this).parent(),e=parseFloat($(this).attr("min")),t=parseFloat($(this).attr("max"));e&&e>0&&parseFloat($(this).val())<e?($(this).val(e),h(WOOFC.lang.min_qty_required,o)):t&&t>0&&parseFloat($(this).val())>t&&($(this).val(t),h(WOOFC.lang.max_stock_reached,o));var n=$(this).closest(".woofc-product"),a=$(this).val();r(n.data("key"),a)}),$(document).on("vclick",".woofc-quantity-up, .woofc-quantity-down",function(o){o.preventDefault();var e=$(this).closest(".woofc-quantity"),t=e.find("input"),n=parseFloat(t.val()),a=parseFloat(t.attr("max")),c=parseFloat(t.attr("min")),i=t.attr("step"),s=n;n&&""!==n&&"NaN"!==n||(n=0),""!==a&&"NaN"!==a||(a=""),""!==c&&"NaN"!==c||(c=0),"any"!==i&&""!==i&&void 0!==i&&"NaN"!==parseFloat(i)||(i=1),$(this).is(".woofc-quantity-up")?a&&(a===n||n>a)?(s=a,h(WOOFC.lang.max_stock_reached,e)):s=n+parseFloat(i):c&&(c===n||n<c)?(s=c,h(WOOFC.lang.min_qty_required,e)):n>0&&(s=n-parseFloat(i));var d=t.closest(".woofc-product"),f=d.data("key");n!==s&&r(f,s)}),N.on("vclick","a",function(o){o.preventDefault();var e=T.find(".woofc-deleted");e.addClass("woofc-undo-deleted"),t(e,!0,function(o){o.removeClass("woofc-deleted woofc-undo-deleted").removeAttr("style");var e=N.data("key");u(e,function(){$(document.body).trigger("woofc_undo_product_remove",[e])}),v()}),N.removeClass("woofc-visible")})}b.length>0&&(_(),l(function(){$("body").addClass("woofc-ready"),$(document).trigger("woofc_ready")})),window.woofc_refresh_cart=l})}(jQuery,window);